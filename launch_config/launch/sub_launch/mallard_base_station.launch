<?xml version="1.0"?>
<launch>
   <!-- Get MALLARD_VERSION. 001_SIM, 002_SIM, 003_SIM, 001_REAL, 002_REAL, 003_REAL, 001_EL -->
   <arg name="ARG_MALLARD_VERSION" value="$(optenv MALLARD_VERSION 001_SIM)" /> 

   <!-- For El-MallARD -->
   <group if="$(eval ARG_MALLARD_VERSION == '001_EL')">
      <include file="$(find launch_config)/launch/sub_launch/el_mallard_base_station.launch"/>
   </group>

   <!-- For other MallARDs -->
   <group unless="$(eval ARG_MALLARD_VERSION == '001_EL')">
      <!-- Connect to ps4 controller, and publish button presses -->
      <node pkg="joy" type="joy_node" name="joy">
         <param name="joy_node/dev" value="/dev/input/js" />
         <param name="coalesce_interval" type="double" value="0.05" />
         <param name="autorepeat_rate" type="double" value="20" />
      </node>

      <!-- This node takes the topic generated by the joypad and converts data into a cmd_vel -->
      <node pkg="control_nodes" type="joy2command.py" name="Joy2cmd" output="screen">
         <rosparam file="$(find launch_config)/$(arg ARG_MALLARD_VERSION)/cfg/yaml/$(arg ARG_MALLARD_VERSION).yaml" command="load"/>
      </node>

      <!-- This node is the thrust allocation - cmd_vel to individual thruster commands -->
      <node pkg="control_nodes" type="cmd2thruster.py" name="Cmd2thr" output="screen">
      </node>

      <!-- Use 3D visualisation "RViz" -->
      <node type="rviz" name="rviz" pkg="rviz" args="-d $(find launch_config)/cfg/rviz/mallard_rviz.rviz" />
   </group>

</launch>
